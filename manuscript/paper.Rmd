---
title: "Preparing the NHANES Data for the Replication of: Association between sleep duration on workdays and blood pressure in non‑overweight/obese population in NHANES: a public database research"
thanks: "Replication files are available on the author's Github account (http://github.com/okutse/sleepBP). **Current version**: `r format(Sys.time(), '%B %d, %Y')`"
subtitle: "Short title goes here!"
author:
- Amos Okutse, Brown University
- Second Author, Another Uni
- Graduate Student, Graduate School
abstract: "**Introduction:** Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec sit amet libero justo. Pellentesque eget nibh ex. Aliquam tincidunt egestas lectus id ullamcorper. 


**Methods:** Proin tellus orci, posuere sed cursus at, bibendum ac odio. Nam consequat non ante eget aliquam. Nulla facilisis tincidunt elit. Nunc hendrerit pellentesque quam, eu imperdiet ipsum porttitor ut. Interdum et malesuada fames ac ante ipsum primis in faucibus. Suspendisse potenti. Duis vitae nibh mauris. Duis nec sem sit amet ante dictum mattis. Suspendisse diam velit, maximus eget commodo at, faucibus et nisi. Ut a pellentesque eros, sit amet suscipit eros. Nunc tincidunt quis risus suscipit vestibulum. Quisque eu fringilla massa."
keywords: "pandoc, r markdown, knitr"
date: "  `r format(Sys.time(), '%d %B, %Y')` "
geometry: margin=1in
#mainfont: cochineal
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
- \usepackage{fvextra}
- \usepackage{float}
- \usepackage{wrapfig}
- \usepackage{amsmath}
- \usepackage{threeparttable} %used to fix table with notes
- \usepackage{float}
- \usepackage{graphicx}
- \usepackage{microtype}
- \usepackage{setspace}
- \usepackage[font=singlespacing]{caption} #can change font here for captions here!!
- \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines, commandchars=\\\{\}}
- \singlespacing
fontsize: 10pt
output:
  bookdown::pdf_document2:
    latex_engine: xelatex
    dev: cairo_pdf
    toc: false
    toc_depth: 4
    number_sections: false
    keep_md: false
link-citations: yes
colorlinks: yes
linkcolor: blue
urlcolor: blue
#bibliography: refs.bib
bibliostyle: apalike
editor_options: 
  markdown: 
    wrap: 72
---

```{r source-file, echo=FALSE, include=FALSE}
# source file 
source(file = "C:/Users/monic/OneDrive/Desktop/SleepBP/data/scrip2.R")
```

# Introduction

-   importance of reproducibility
-   As a case on point ...?
-   Underscores the importance of reproducibility within the frame of
    statistical analysis. We use the study by to ... The current study
    builds on the paper by .. and starts in the manner of a replication
    study and extends the analyses therein. We focus on statistical
    analyses of these data and compare models based on varied
    specification of functional forms of the covariates.

# Methods

## Study population

Data utilized in this paper is sourced from the National Health and
Nutrition Examination Survey (NHANES), a comprehensive nationwide survey
administered by the National Center for Health Statistics (NCHS) via the
Centers for Disease Control and Prevention (CDC). The survey assesses
the health and nutrition of the entire non-institutionalized US
population, spanning all ages and residing in all 50 states as well as
Washington D.C. As such, the survey provides a cross-sectional view of a
representative sample of the US population. Further information about
NHANES can be found at www.cdc.gov/nchs/nhanes.

## Data

Our current analyses combine the 2015 - 2018 NHANES survey cycles to
yield $n = 19225$ observations on 35 covariates. This sample size was
comprised $n = 9971$ and $n = 9254$ observations from the 2015/2016 and
2017/2018 survey cycles, respectively. Analyses excluded individuals
with missing data on sleep ($n = 6818$), blood pressure (BP) (n = 1055),
and body mass index (BMI) or those with BMI \> 25 kg/$m^2$ (overweight)
(n = 5521). Individuals that reported being on anti-hypertensive
medication were also excluded from further analyses (n = 2944).

### Outcome definition:

We defined our outcome as systolic and diastolic blood pressure. These
variables are measured by trained examiners using standardized
procedures. Given that systolic and diastolic blood pressure
measurements are taken at least four times on an individual, our
definition of these outcome is based on an average of the first three
blood pressure measurements.

### Exposure:

Sleep duration on workdays was evaluated by the questionnaire with the
following questions: "Number of hours usually sleep on weekdays or
workdays". Sleep duration was divided into three groups, which were \< 6
h, 6--8 h, ≥ 8 h respectively, of which 6--8 h was used as the reference
group.

### Covariates:

In addition to the exposure and outcome variables, our analyses included
the following as covariates: Race divided into four groups as Mexican
American, white, black and other race. Alcohol consumption was grouped
into drinking, no drinking, not recorded. Smoking status as smoking, not
smoking, not recorded. Diabetes was defined as yes, no, borderline, or
not recorded. Hypertension was defined as yes, no, or not recorded.
Snorting was defined as yes, no, and not recorded. US citizenship status
was defined as citizen by birth or naturalization, don't know, not a
citizen, or refused to answer. Education level was grouped into four
categories including graduate studies, high school, less than grade 12
or some college. Additional covariates included marital status, gender,
age, albumin, creatinine,hemoglobin, total cholesterol (TC), aspertate
aminotransferase (AST), high-density lipoprotein (HDL), and body mass
index (BMI). Details about these variables can be found at
<https://wwwn.cdc.gov/nchs/nhanes/search/default.aspx>. Age, albumin,
creatinine, hemoglobin, TC, AST, HDL, and BMI were analyzed as
continuous variables whereas gender, alcohol consumption, diabetes,
smoking, race, hypertension, and snorting were analyzed as categorical
variables. Table \@ref{tab:tabone} highlights the variable names and
descriptions as utilized in this study.

| Variable | Name                    | Description                                                                                                                                  |
|-----------------|-----------------|--------------------------------------|
| SEQN     | sequence number         | Respondent number                                                                                                                            |
| SDMVPSU  | psu                     | Masked variance unit pseudo-PSU variable for variance estimation                                                                             |
| WTINT2YR | weights                 | Full sample 2-year interview weights                                                                                                         |
| SDMVSTRA | strata                  | Masked variance unit pseudo-stratum variable for variance estimation                                                                         |
| RIAGENDR | gender                  | Respondent's number                                                                                                                          |
| RIDAGEYR | age (yrs)               | Respondent's age in years                                                                                                                    |
| DMDMARTL | marital status          | Marital status                                                                                                                               |
| INDFMIN2 | income category         | Total family income (reported as a range value in dollars)                                                                                   |
| RIDRETH3 | race                    | Recode of reported race and Hispanic origin information, with Non-Hispanic Asian Category                                                    |
| DMDHHSZA | children \<5            | Number of children aged 5 years or younger in the household                                                                                  |
| DMDEDUC2 | education level         | What is the highest grade or level of school {you have/SP has} completed or the highest degree {you have/s/he has} received?                 |
| DMDCITZN | citizenship status      | {Are you/Is SP} a citizen of the United States? [Information about citizenship is being collected by the U.S. Public Health Serv             |
| SLD012   | sleep                   | Number of hours usually sleep on weekdays or workdays                                                                                        |
| BMXBMI   | bmi                     | Body mass index                                                                                                                              |
| ALQ121   | alcohol use             | In the past 12 months, how often did you drink any type of alcoholic beverage?                                                               |
| LBDHDDSI | hdl                     | High density lipoprotein                                                                                                                     |
| LBDSALSI | albumin                 | Albumin (g/L)                                                                                                                                |
| DIQ010   | diabetes                | Have you ever been told by a doctor or health professional that you have diabetes or sugar diabetes?                                         |
| BPQ020   | hypertension            | {Have you/Has SP} ever been told by a doctor or other health professional that {you/s/he} had hypertension, also called high blood pressure? |
| URXCRS   | creatinine              | Creatinine, urine (umol/L)                                                                                                                   |
| SLQ040   | snort                   | In the past 12 months, how often did {you/SP} snort, gasp, or stop breathing while {you were/s/he was} asleep?                               |
| LBDTCSI  | total cholestrol levels | Total cholesterol (mmol/L)                                                                                                                   |
| LBXHGB   | hemoglobin              | Hemoglobin (g/dL)                                                                                                                            |
| LBXSASSI | AST                     | Aspartate aminotransferase                                                                                                                   |
| SMQ040   | smoke                   | Do you now smoke cigarettes?                                                                                                                 |
| BPXDI    | blood pressure          | Systolic and diastolic blood pressure taken as the average of the first three measurements                                                   |

```{r tabone, echo=FALSE}
#tab.one <- as_kable_extra(vars, caption = "Variable names and descriptions", 
#                 format = "latex", booktabs = TRUE) %>% 
#  kable_styling(latex_options = c("HOLD_position") %>% 
#  row_spec(c(0), bold = TRUE) %>% 
#  column_spec(c(1, 2), bold = TRUE, width = "2cm") %>% 
#  column_spec(3, width = "8cm")
#tab.one


#vars %>% kable(booktabs = T) %>% kable_styling(latex_options = "scale_down")


```

## Statistical modeling

With the purpose of identifying influential variables impacting blood
pressure, a variable selection process was conducted. The initial
approach involved employing best subset selection with 10-fold
cross-validation to ascertain the optimal number of subsets. Notably,
for systolic blood pressure, the forward best subset selection method
discerned 13 variables, whereas diastolic blood pressure exhibited 19
selected variables. However, a limitation inherent in forward best
subset selection is its inability to eliminate previously selected
features, potentially disregarding their relevance in light of newly
added variables. Consequently, this methodology may yield sub-optimal
variable selections due to its lack of adaptability.

In an effort to mitigate this limitation and introduce regularization,
LASSO regularization was employed. This involved a 10-fold
cross-validation process to determine the optimal penalty parameter,
$\lambda$ . For diastolic blood pressure, the $\lambda$ value associated
with the lowest mean squared error (MSE) led to the selection of 25
variables. Conversely, when considering systolic blood pressure, the
$\lambda$ value minimizing the MSE resulted in the exclusion of a sole
variable. Subsequently, a $\lambda$ value was strategically chosen to
ensure a negligible increase of no more than 1% in MSE, ultimately
leading to the inclusion of 29 variables in the model.

# Results

Table \@ref(tab:tabtwo) summarizes participant characteristics in the
2015 - 2018 NHANES survey cycles stratified by gender. Among the
participants, the proportion of males and females were 44.81% (n = 1378)
and 55.19% (n = 1509), respectively. With ethnicity, the proportion of
Mexican American, White and Black were 6.27%, 64.62% and 9.94%,
respectively. Overall, the mean (SD) values for age, albumin,
creatinine, SBP, DBP, hemoglobin, TC, AST, HDL, BMI were 38.54 (17.72)
years, 43.48 (3.58) g/L, 73.21 (19.73) umol/L, 115.33 (14.56) mmHg,
68.47 (10.08) mmHg, 14.07(1.44)g/dL, 4.67 (1.01) mmol/L, 23.18 (13.01)
IU/L, 1.59 (0.43) mmol/L, and 21.97(2.06) kg/m2, respectively. Among the
participants, 66.01% were consumed alcohol drinkers, 2.61% were
diabetes, 3.16% were hypertension, 6.72% have snort or stop breathing.
17.99% were smokers. Sleep duration was divided into three groups, which
were \< 6 h, 6--8 h, ≥ 8 h, each with a proportion of 6.26%, 40.53%,
53.21%, respectively.

Male and female participants differed significantly on characteristics
including

The uni-variate analysis of potential confounding factors is shown in
Table 2.

```{r tabtwo, echo=FALSE}
#tabsum %>% 
#  as_kable_extra(format = "latex", caption = "Unweighted summary characteristics of the participants in the NHANES 2015 - 2018 survey cycles stratified by gender.", digits = 2, longtable = T) %>% 
#  kable_styling(latex_options = c("HOLD_position"))

tabsum %>%
  as_kable_extra(booktabs = TRUE, 
                 caption = "Unweighted summary characteristics of the participants in the NHANES 2015 - 2018 survey cycles stratified by gender.", 
                 longtable = TRUE) %>%
  kable_styling(latex_options = "scale_down")
```

### Foward Stepwise Best Subset

```{=tex}
\begin{align*}
\text{sbp} = &\, 85.65 + 0.47 \times \text{BMI} + 1.49 \times \text{total\_chol} - 0.00 \times \text{creatinine} \\
&+ 3.06 \times \text{educ\_levelHighschool} + 2.00 \times \text{educ\_levelLess12grade} + 1.31 \times \text{educ\_levelsomCollege} \\
&+ 4.59 \times \text{genderMale} + 0.47 \times \text{age\_yr} + 2.05 \times \text{marital\_statusLiving with partner} \\
&- 0.12 \times \text{marital\_statusMarried} + 3.30 \times \text{marital\_statusNever married} \\
&- 0.99 \times \text{marital\_statusSeparated} + 7.01 \times \text{marital\_statusWidowed} - 1.30 \times \text{sleep>8hrs} \\
&- 2.82 \times \text{sleep6-8hrs} - 4.60 \times \text{raceMexican American} - 3.78 \times \text{raceOther} \\
&- 5.03 \times \text{raceWhite income\_categoryLower-middle income} - 3.02 \times \text{income\_categoryMiddle income} \\
&- 2.88 \times \text{income\_categoryUnknown/Refused} - 2.70 \times \text{income\_categoryUpper-middle income} \\
&- 4.30 \times \text{income\_categoryVaried/High income}
\end{align*}
```
```{=tex}
\begin{align*}
\text{dbp} = &\, 53.55 + 0.22 \times \text{BMI} + 0.78 \times \text{total\_chol} + 0.85 \times \text{hemoglobin} + 0.02 \times \text{albumin} \\
&+ 0.03 \times \text{AST} - 0.89 \times \text{diabetesNo} - 3.37 \times \text{diabetesYes} - 1.06 \times \text{children..51} \\
&- 1.67 \times \text{children..52} - 1.83 \times \text{children..53 or more} - 1.90 \times \text{marital\_statusLiving with partner} \\
&+ 0.00 \times \text{marital\_statusMarried} - 2.78 \times \text{marital\_statusNever married} + 0.91 \times \text{marital\_statusSeparated} \\
&+ 1.72 \times \text{marital\_statusWidowed} - 2.40 \times \text{sleep>8hrs} - 2.37 \times \text{sleep6-8hrs} - 2.76 \times \text{raceMexican American} \\
&+ 0.14 \times \text{raceOther} - 1.98 \times \text{raceWhite} - 2.16 \times \text{snortNot recorded} \\
&- 0.57 \times \text{snortYes} - 2.33 \times \text{alcoholNo drinking} - 1.79 \times \text{alcoholNot recorded}
\end{align*}
```
### LASSO

```{=tex}
\begin{align*}
\text{sbp} = &\, 84.13 \times \text{(Intercept)} + 0.52 \times \text{bmi} + 0.79 \times \text{hdl} + 1.43 \times \text{total\_chol} + 0.04 \times \text{AST} \\
&- 0.17 \times \text{diabetesNo} + 1.88 \times \text{diabetesYes} - 14.02 \times \text{citizenship\_statusDon't Know} \\
&- 0.59 \times \text{citizenship\_statusNot a citizen of the US} - 12.06 \times \text{citizenship\_statusRefused} \\
&+ 3.09 \times \text{educ\_levelHighschool} + 2.19 \times \text{educ\_levelLess12grade} + 1.16 \times \text{educ\_levelsomeCollege} \\
&- 0.99 \times \text{children..51} - 1.17 \times \text{children..52} + 0.90 \times \text{children..53 or more} \\
&+ 4.42 \times \text{genderMale} + 0.44 \times \text{age\_yr} + 1.77 \times \text{marital\_statusLiving with partner} \\
&+ 0.01 \times \text{marital\_statusMarried} + 2.95 \times \text{marital\_statusNever married} - 1.05 \times \text{marital\_statusSeparated} \\
&+ 7.19 \times \text{marital\_statusWidowed} - 1.47 \times \text{sleep>8hrs} - 2.95 \times \text{sleep6-8hrs} \\
&- 4.11 \times \text{raceMexican American} - 3.43 \times \text{raceOther} - 5.14 \times \text{raceWhite} \\
&+ 1.75 \times \text{smokeNot Smoking} + 0.22 \times \text{smokeSmoking} - 2.74 \times \text{snortNot recorded} \\
&- 0.61 \times \text{snortYes} - 1.69 \times \text{alcoholNo drinking} - 0.28 \times \text{alcoholNot recorded} \\
&- 1.62 \times \text{income\_categoryLower-middle income} - 3.04 \times \text{income\_categoryMiddle income} \\
&- 2.64 \times \text{income\_categoryUnknown/Refused} - 2.71 \times \text{income\_categoryUpper-middle income} \\
&- 4.54 \times \text{income\_categoryVaried/High income}
\end{align*}
```
```{=tex}
\begin{align*}
\text{dbp} = &\, 47.99 + 0.24 \times \text{bmi} + 0.80 \times \text{total\_chol} + 0.58 \times \text{hemoglobin} + 0.17 \times \text{albumin} \\
&+ 0.04 \times \text{AST} - 0.42 \times \text{diabetesNo} - 3.18 \times \text{diabetesYes} + 1.36 \times \text{citizenship\_statusDon't Know} \\
&- 0.60 \times \text{citizenship\_statusNot a citizen of the US} - 1.78 \times \text{citizenship\_statusRefused} \\
&- 0.11 \times \text{educ\_levelHighschool} - 0.92 \times \text{educ\_levelLess12grade} - 0.39 \times \text{educ\_levelsomeCollege} \\
&- 0.99 \times \text{children..51} - 1.39 \times \text{children..52} - 2.08 \times \text{children..53 or more} \\
&+ 0.59 \times \text{genderMale} + 0.01 \times \text{age\_yr} - 1.77 \times \text{marital\_statusLiving with partner} \\
&+ 0.12 \times \text{marital\_statusMarried} - 2.67 \times \text{marital\_statusNever married} + 0.94 \times \text{marital\_statusSeparated} \\
&+ 1.69 \times \text{marital\_statusWidowed} + 2.21 \times \text{cycle} - 2.21 \times \text{sleep>8hrs} \\
&- 2.25 \times \text{sleep6-8hrs} - 2.08 \times \text{raceMexican American} + 0.31 \times \text{raceOther} \\
&- 2.09 \times \text{raceWhite} + 0.44 \times \text{smokeNot Smoking} + 0.75 \times \text{smokeSmoking} \\
&- 2.15 \times \text{snortNot recorded} - 0.50 \times \text{snortYes} - 1.28 \times \text{alcoholNo drinking} \\
&- 1.17 \times \text{alcoholNot recorded}
\end{align*}
```
# Discussion and conclusion

# References
